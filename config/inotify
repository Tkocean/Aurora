#!/system/bin/sh
SPATH=$(dirname "$(readlink -f "$0")")
export PATH="$(magisk --path)/.magisk/busybox:/data/adb/ksu/bin:$PATH"
source ${SPATH}/Aurora.ini
signal_file=${DATADIR}/$(uname -m)

case "$3" in
  disable)
    touch ${signal_file}
    if [ "$1" = "d" ] ; then
      Aurora enable
    elif [ "$1" = "n" ] ; then
      Aurora $3
    fi
    rm ${signal_file}
    ;;
  updata)
    touch ${signal_file}
    if [ "$1" = "d" ] ; then
      Aurora set
    elif [ "$1" = "n" ] ; then
      Aurora $3
    fi
    rm ${signal_file}
    ;;
  remove)
    touch ${signal_file}
    if [ "$1" = "d" ] ; then
      Aurora a
    elif [ "$1" = "n" ] ; then
      Aurora e
    fi
    rm ${signal_file}
    ;;
  upkernel)
    touch ${signal_file}
    if [ "$1" = "d" ] ; then
      Aurora bin
    elif [ "$1" = "n" ] ; then
      Aurora $3
    fi
    rm ${signal_file}
    ;;
  backup)
    touch ${signal_file}
    if [ "$1" = "d" ] ; then
      Aurora $3
    elif [ "$1" = "n" ] ; then
      sleep 2 && rm $2$3
    fi
    rm ${signal_file}
    ;;
  renet)
    touch ${signal_file}
    if [ "$1" = "d" ] ; then
      Aurora net true
    elif [ "$1" = "n" ] ; then
      Aurora net false
      sleep 2 && rm $2$3
    fi
    rm ${signal_file}
    ;;
esac